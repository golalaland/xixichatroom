<script>
// Format numbers with commas
function formatNumber(num) {
  return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
}

// Stars + Cash live update
let stars = 0;
let cash = 0;
setInterval(() => {
  stars++;
  cash = stars * 10; // example conversion
  document.getElementById("starCount").textContent = formatNumber(stars);
  document.getElementById("cashCount").textContent = "â‚¦" + formatNumber(cash);
}, 10000);

// Chat ID chooser logic
function showChatIdChooser() {
  if (!localStorage.getItem("chatId")) {
    const chooser = document.createElement("div");
    chooser.style.position = "fixed";
    chooser.style.top = "0";
    chooser.style.left = "0";
    chooser.style.width = "100%";
    chooser.style.height = "100%";
    chooser.style.background = "rgba(20,20,20,0.95)";
    chooser.style.display = "flex";
    chooser.style.alignItems = "center";
    chooser.style.justifyContent = "center";
    chooser.style.zIndex = "9999";

    chooser.innerHTML = `
      <div style="background:#111;padding:20px;border:2px solid var(--accent);border-radius:8px;color:#fff;text-align:center;">
        <h2 style="margin-bottom:15px;">Choose your Chat ID</h2>
        <input id="chatIdInput" type="text" placeholder="Enter Chat ID" 
               style="padding:10px;width:220px;background:#222;color:#fff;
               border:1px solid var(--accent);border-radius:5px;font-weight:bold;">
        <br><br>
        <button id="saveChatId" 
          style="padding:10px 18px;background:var(--accent);color:#fff;
                 border:none;border-radius:5px;cursor:pointer;">OK</button>
      </div>
    `;
    document.body.appendChild(chooser);

    document.getElementById("saveChatId").addEventListener("click", () => {
      const val = document.getElementById("chatIdInput").value.trim();
      if (val) {
        localStorage.setItem("chatId", val);
        location.reload();
      }
    });
  }
}

// Trigger Chat ID chooser only once, 5s after login
function handleGoogleSignIn() {
  // your firebase auth login success hook should call this
  setTimeout(() => {
    showChatIdChooser();
  }, 5000);
}
</script>
